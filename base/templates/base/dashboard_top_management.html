{% extends "base/base.html" %}
{% load static %}

{% block title %}Top Management Dashboard{% endblock %}

{% block content %}
<h2>Welcome, {{ user.get_full_name|default:user.username }} (Top Management)</h2>

<div class="dashboard-summary" style="display:flex; gap:20px; margin-bottom:30px;">
    <div class="summary-box" style="padding:20px; background:#e3f2fd; border-radius:8px; flex:1; text-align:center;">
        <h3>Total Assets Under Management (AUM)</h3>
        <p style="font-size: 2.5rem; font-weight:bold; color:#1565c0;">₹{{ total_aum|floatformat:2 }}</p>
    </div>
    <div class="summary-box" style="padding:20px; background:#e8f5e9; border-radius:8px; flex:1; text-align:center;">
        <h3>Total Monthly SIPs</h3>
        <p style="font-size: 2.5rem; font-weight:bold; color:#2e7d32;">{{ total_sips }}</p>
    </div>
    <div class="summary-box" style="padding:20px; background:#fff3e0; border-radius:8px; flex:1; text-align:center;">
        <h3>Total Team Members</h3>
        <p style="font-size: 2.5rem; font-weight:bold; color:#ef6c00;">{{ total_team_members }}</p>
    </div>
</div>

<h3>Team Performance Overview</h3>

<table border="1" cellpadding="10" cellspacing="0" width="100%" style="border-collapse: collapse;">
    <thead style="background-color:#90caf9;">
        <tr>
            <th>Business Head</th>
            <th>RM Heads Under Them</th>
            <th>Total Leads</th>
            <th>Monthly SIP</th>
            <th>Total AUM</th>
        </tr>
    </thead>
    <tbody>
        {% for bh in business_heads %}
        <tr>
            <td>{{ bh.get_full_name|default:bh.username }}</td>
            <td>{{ bh.rm_heads_count }}</td>
            <td>{{ bh.leads_count }}</td>
            <td>₹{{ bh.monthly_sip|floatformat:2 }}</td>
            <td>₹{{ bh.aum|floatformat:2 }}</td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="5" style="text-align:center;">No Business Heads data found.</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<div style="margin-top: 30px;">
    <a href="{% url 'dashboard_business_head' %}">Go to Business Head Dashboard</a> | 
    <a href="{% url 'lead_list' %}">View All Leads</a>
</div>

{% endblock %}
