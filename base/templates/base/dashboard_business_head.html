{% extends "base/base.html" %}
{% load static %}

{% block title %}Business Head Dashboard{% endblock %}

{% block content %}
<h2>Welcome, {{ user.get_full_name|default:user.username }} (Business Head)</h2>

<div class="dashboard-summary" style="display:flex; gap:20px; margin-bottom:30px;">
    <div class="summary-box" style="padding:20px; background:#f0f0f0; border-radius:8px; flex:1;">
        <h3>Total RM Heads</h3>
        <p style="font-size: 2rem; font-weight:bold;">{{ rm_heads_count }}</p>
    </div>
    <div class="summary-box" style="padding:20px; background:#f0f0f0; border-radius:8px; flex:1;">
        <h3>Total Leads</h3>
        <p style="font-size: 2rem; font-weight:bold;">{{ leads_count }}</p>
    </div>
    <div class="summary-box" style="padding:20px; background:#f0f0f0; border-radius:8px; flex:1;">
        <h3>Service Requests</h3>
        <p style="font-size: 2rem; font-weight:bold;">{{ service_requests_count }}</p>
    </div>
</div>

<h3>RM Heads under your supervision</h3>
<table border="1" cellpadding="10" cellspacing="0" width="100%" style="border-collapse: collapse;">
    <thead>
        <tr style="background-color:#ddd;">
            <th>Name</th>
            <th>Email</th>
            <th>Number of Leads</th>
            <th>Number of Tasks</th>
        </tr>
    </thead>
    <tbody>
        {% for rm_head in rm_heads %}
        <tr>
            <td>{{ rm_head.get_full_name|default:rm_head.username }}</td>
            <td>{{ rm_head.email }}</td>
            <td>{{ rm_head.leads_count }}</td>
            <td>{{ rm_head.tasks_count }}</td>
        </tr>
        {% empty %}
        <tr>
            <td colspan="4" style="text-align:center;">No RM Heads found.</td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<div style="margin-top: 30px;">
    <a href="{% url 'lead_list' %}">View All Leads</a> | 
    <a href="{% url 'service_request_list' %}">View Service Requests</a> | 
    <a href="{% url 'task_list' %}">View Tasks</a>
</div>

{% endblock %}
